<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Voucher • Grupo DV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>

/* ---------------------------------------------------
   PALETA PREMIUM PRETO + DOURADO
--------------------------------------------------- */
:root{
  --bg:#0d0d0d;
  --card:#161616;
  --gold:#d4af37;
  --gold2:#b88e1a;
  --white:#f5f5f5;
  --radius:16px;
  --shadow:0 6px 20px rgba(0,0,0,.45);
  --transition:.25s ease;
}

body{
  margin:0;
  background:var(--bg);
  font-family:Inter, sans-serif;
  color:var(--white);
}

/* ---------------------------------------------------
   SISTEMA DE TELAS
--------------------------------------------------- */
.screen{
  display:none;
  padding:22px;
  animation:fade .25s ease;
}

.screen.active{ display:block; }

@keyframes fade{ from{opacity:0;} to{opacity:1;} }

/* ---------------------------------------------------
   TÍTULOS
--------------------------------------------------- */
.title{
  font-size:22px;
  color:var(--gold);
  text-align:center;
  font-weight:600;
  margin-bottom:10px;
}

.subtitle{
  text-align:center;
  font-size:14px;
  color:#bbb;
  margin-bottom:20px;
}

/* ---------------------------------------------------
   BOTÕES
--------------------------------------------------- */
.btn{
  width:100%;
  padding:14px;
  margin-top:18px;
  background:var(--gold);
  border:none;
  border-radius:var(--radius);
  font-size:17px;
  font-weight:700;
  color:black;
  cursor:pointer;
  transition:var(--transition);
}

.btn:hover{ background:var(--gold2); }

.btnBack{
  background:#444;
  color:white;
}

.btnBack:hover{
  background:#666;
}

/* ---------------------------------------------------
   CARDS DE VALOR
--------------------------------------------------- */
.values{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.cardValor{
  background:var(--card);
  border:2px solid var(--gold);
  border-radius:var(--radius);
  padding:14px 0;
  text-align:center;
  font-size:20px;
  font-weight:600;
  cursor:pointer;
  transition:var(--transition);
}

.cardValor:hover{ background:#222; }
.cardValor.sel{
  background:var(--gold);
  color:black;
}

/* ---------------------------------------------------
   CAMPOS
--------------------------------------------------- */
input, select{
  width:100%;
  padding:13px;
  margin-top:14px;
  background:var(--card);
  border:2px solid var(--gold);
  border-radius:var(--radius);
  font-size:16px;
  color:white;
}

/* ---------------------------------------------------
   RESUMO / VOUCHER
--------------------------------------------------- */
.box{
  background:var(--card);
  padding:18px;
  border-radius:var(--radius);
  border:2px solid var(--gold);
  box-shadow:var(--shadow);
  margin-bottom:15px;
}

.box h3{
  margin:0 0 12px;
  text-align:center;
  color:var(--gold);
}

.line{
  font-size:16px;
  margin-bottom:6px;
}

#pixArea{ display:none; }

</style>
</head>
<body>

<!-- ====================================================
              TELA 1 — VALOR
==================================================== -->
<div class="screen active" id="t1">
  <div class="title">1º Passo</div>
  <div class="subtitle">Selecione o valor do voucher</div>

  <div class="values">
    <div class="cardValor" onclick="selectValor(50)">R$ 50</div>
    <div class="cardValor" onclick="selectValor(80)">R$ 80</div>
    <div class="cardValor" onclick="selectValor(100)">R$ 100</div>
    <div class="cardValor" onclick="selectValor(150)">R$ 150</div>
    <div class="cardValor" onclick="selectValor(200)">R$ 200</div>
    <div class="cardValor" onclick="outroValor()">Outro</div>
  </div>
</div>

<!-- ====================================================
              TELA 1.1 — OUTRO VALOR
==================================================== -->
<div class="screen" id="t1b">
  <div class="title">Informe o valor</div>
  <input id="outroInput" inputmode="numeric" oninput="maskValor(this)">
  <button class="btn" onclick="confirmarOutro()">Confirmar</button>
  <button class="btn btnBack" onclick="show('t1')">Voltar</button>
</div>

<!-- ====================================================
              TELA 2 — DADOS
==================================================== -->
<div class="screen" id="t2">
  <div class="title">2º Passo</div>
  <div class="subtitle">Preencha seus dados</div>

  <input id="nome" placeholder="Nome completo">
  <input id="whats" placeholder="WhatsApp" oninput="maskWhats(this)">
  <input id="emailComprador" placeholder="Seu e-mail">

  <select id="presente" onchange="togglePresente()">
    <option value="">É presente?</option>
    <option value="nao">Não</option>
    <option value="sim">Sim</option>
  </select>

  <input id="emailPresente" placeholder="Email do presenteado" style="display:none;">

  <button class="btn" onclick="validateT2()">Avançar</button>
  <button class="btn btnBack" onclick="show('t1')">Voltar</button>
</div>

<!-- ====================================================
              TELA 3 — REVISÃO
==================================================== -->
<div class="screen" id="t3">
  <div class="title">3º Passo</div>
  <div class="subtitle">Revise as informações</div>

  <div class="box">
    <h3>Resumo</h3>
    <div class="line" id="r_valor"></div>
    <div class="line" id="r_nome"></div>
    <div class="line" id="r_email"></div>
    <div class="line" id="r_presente"></div>
  </div>

  <button class="btn" onclick="validateT3()">Enviar e Realizar Pagamento</button>
  <button class="btn btnBack" onclick="show('t2')">Voltar</button>
</div>

<!-- ====================================================
              TELA PIX — APÓS REGISTRO
==================================================== -->
<div class="screen" id="t4">
  <div class="title">Pagamento PIX</div>

  <div class="box">
    <h3>Voucher Registrado</h3>
    <div class="line">
      Seu voucher foi registrado.<br>
      Realize o pagamento para ativação.
    </div>
    <div class="line" id="emailsResumo"></div>
  </div>

  <div class="box" id="pixArea">
    <h3>CHAVE PIX</h3>
    <div class="line" id="pixCode">SUA_CHAVE_PIX_AQUI</div>
    <button class="btn" onclick="copyPix()">Copiar chave PIX</button>
  </div>

  <button class="btn btnBack" onclick="resetAll()">Voltar ao início</button>
</div>

<script>

let valor = 0;

/* ---------------------------------------------------
               CONTROLE DE TELAS
--------------------------------------------------- */
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ---------------------------------------------------
                SELEÇÃO DE VALOR
--------------------------------------------------- */
function selectValor(v){
  valor = v;
  document.querySelectorAll('.cardValor').forEach(c=>c.classList.remove('sel'));
  event.target.classList.add('sel');
  show('t2');
}

function outroValor(){ show('t1b'); }

function maskValor(i){
  let v = i.value.replace(/\D/g,"");
  v = (v/100).toFixed(2).replace('.',',');
  i.value = "R$ "+v;
}

function confirmarOutro(){
  let v = document.getElementById("outroInput").value;
  valor = Number(v.replace(/\D/g,""))/100;
  show('t2');
}

/* ---------------------------------------------------
                 VALIDAR TELA 2
--------------------------------------------------- */
function togglePresente(){
  let p = document.getElementById("presente").value;
  document.getElementById("emailPresente").style.display =
    p==="sim" ? "block" : "none";
}

function maskWhats(i){
  let v = i.value.replace(/\D/g,"");
  v = v.replace(/^(\d{2})(\d)/,"($1) $2");
  v = v.replace(/(\d{5})(\d)/,"$1-$2");
  i.value = v;
}

function validateT2(){
  if(!document.getElementById("nome").value ||
     !document.getElementById("whats").value ||
     !document.getElementById("emailComprador").value){
      alert("Preencha todos os campos.");
      return;
  }

  // Preenche resumo
  document.getElementById("r_valor").innerHTML =
    "<b>Valor:</b> R$ "+valor.toFixed(2).replace('.',',');

  document.getElementById("r_nome").innerHTML =
    "<b>Nome:</b> "+document.getElementById("nome").value;

  document.getElementById("r_email").innerHTML =
    "<b>Email:</b> "+document.getElementById("emailComprador").value;

  let p = document.getElementById("presente").value;
  document.getElementById("r_presente").innerHTML =
    p==="sim"
    ? "<b>Presente para:</b> "+document.getElementById("emailPresente").value
    : "";

  show('t3');
}

/* ---------------------------------------------------
             AO CLICAR "ENVIAR E REALIZAR PAGAMENTO"
--------------------------------------------------- */
function validateT3(){

  // ENVIA PARA PLANILHA
  fetch("URL_DO_WEBAPP",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      acao:"registrar",
      valor:valor,
      nomeComprador:document.getElementById("nome").value,
      emailComprador:document.getElementById("emailComprador").value,
      whats:document.getElementById("whats").value,
      presente:document.getElementById("presente").value,
      emailPresente:document.getElementById("emailPresente").value
    })
  })
  .then(r=>r.json())
  .then(res=>{

    document.getElementById("emailsResumo").innerHTML =
      "<b>E-mails cadastrados:</b><br>"+
      document.getElementById("emailComprador").value+
      (document.getElementById("presente").value==="sim"
        ? "<br>"+document.getElementById("emailPresente").value
        : "");

    show('t4');

    // Libera PIX
    document.getElementById("pixArea").style.display = "block";
  });
}

/* ---------------------------------------------------
                    PIX
--------------------------------------------------- */
function copyPix(){
  navigator.clipboard.writeText(
    document.getElementById("pixCode").innerText
  );
  alert("Chave copiada!");
}

/* ---------------------------------------------------
                    RESET
--------------------------------------------------- */
function resetAll(){
  location.reload();
}

</script>

</body>
</html>
