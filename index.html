<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Voucher • Grupo DV</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<style>

/* =============================== */
/* TEMA PREMIUM PRETO + DOURADO */
/* =============================== */
:root{
  --bg:#0b0b0b;
  --card:#171717;
  --gold:#d4af37;
  --gold2:#b88e1a;
  --white:#f5f5f5;
  --radius:14px;
  --shadow:0 6px 18px rgba(0,0,0,.4);
}

body{
  margin:0;
  padding:0;
  background:var(--bg);
  font-family:'Inter',sans-serif;
  color:white;
  overflow-x:hidden;
}

/* =============================== */
/* TELAS PASSO A PASSO */
/* =============================== */
.screen{
  display:none;
  padding:22px;
  animation:fade .25s ease;
}
.screen.active{ display:block; }

@keyframes fade{ from{opacity:0;} to{opacity:1;} }

/* =============================== */
.title{
  font-size:20px;
  font-weight:700;
  text-align:center;
  color:var(--gold);
}
.subtitle{
  text-align:center;
  font-size:13px;
  color:#bcbcbc;
  margin-bottom:20px;
}

/* =============================== */
.btn{
  width:100%;
  padding:12px;
  border:none;
  border-radius:var(--radius);
  background:var(--gold);
  font-size:16px;
  font-weight:700;
  color:black;
  margin-top:16px;
}
.btn:hover{ background:var(--gold2); }

.btnBack{
  background:#333;
  color:white;
}

/* =============================== */
input,select{
  width:100%;
  padding:11px;
  margin-top:14px;
  background:var(--card);
  border:2px solid var(--gold);
  border-radius:var(--radius);
  font-size:15px;
  color:white;
  outline:none;
}

/* =============================== */
.values{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.cardValor{
  background:var(--card);
  border:2px solid var(--gold);
  padding:12px 0;
  border-radius:var(--radius);
  text-align:center;
  font-size:18px;
  cursor:pointer;
}
.cardValor.sel{
  background:var(--gold);
  color:black;
}

/* =============================== */
.box{
  background:var(--card);
  border-radius:var(--radius);
  border:2px solid var(--gold);
  padding:16px;
  box-shadow:var(--shadow);
}
.box h3{
  text-align:center;
  color:var(--gold);
  margin-top:0;
}
.line{ font-size:15px; margin-bottom:6px; }

/* =============================== */
/* OVERLAY DE LOADING */
/* =============================== */
.overlay{
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,.75);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:900;
}
.loader{
  width:50px;
  height:50px;
  border:4px solid var(--gold2);
  border-top-color:var(--gold);
  border-radius:50%;
  animation:spin .8s linear infinite;
}
@keyframes spin{ to{transform:rotate(360deg);} }

</style>
</head>
<body>

<!-- OVERLAY -->
<div class="overlay" id="overlay">
  <div class="loader"></div>
</div>

<!-- =============================== -->
<!-- TELA 1 — VALOR -->
<!-- =============================== -->
<div class="screen active" id="t1">
  <div class="title">1º Passo</div>
  <div class="subtitle">Escolha o valor do voucher</div>

  <div class="values">
    <div class="cardValor" onclick="selectValor(50)">R$ 50</div>
    <div class="cardValor" onclick="selectValor(80)">R$ 80</div>
    <div class="cardValor" onclick="selectValor(100)">R$ 100</div>
    <div class="cardValor" onclick="selectValor(150)">R$ 150</div>
    <div class="cardValor" onclick="selectValor(200)">R$ 200</div>
    <div class="cardValor" onclick="show('t1b')">Outro</div>
  </div>
</div>

<!-- =============================== -->
<!-- TELA 1B — OUTRO VALOR -->
<!-- =============================== -->
<div class="screen" id="t1b">
  <div class="title">Digite o valor</div>
  <input id="outroValor" inputmode="numeric" oninput="maskValor(this)">
  <button class="btn" onclick="confirmarOutro()">Confirmar</button>
  <button class="btn btnBack" onclick="show('t1')">Voltar</button>
</div>

<!-- =============================== -->
<!-- TELA 2 — DADOS -->
<!-- =============================== -->
<div class="screen" id="t2">
  <div class="title">2º Passo</div>
  <div class="subtitle">Insira seus dados</div>

  <input id="nome" placeholder="Nome completo">
  <input id="whats" placeholder="WhatsApp" inputmode="numeric" oninput="maskWhats(this)">
  <input id="emailComprador" placeholder="Seu e-mail">

  <select id="presente" onchange="togglePresente()">
    <option value="">É presente?</option>
    <option value="nao">Não</option>
    <option value="sim">Sim</option>
  </select>

  <input id="emailPresente" placeholder="Email do presenteado" style="display:none;">

  <button class="btn" onclick="validateT2()">Avançar</button>
  <button class="btn btnBack" onclick="show('t1')">Voltar</button>
</div>

<!-- =============================== -->
<!-- TELA 3 — REVISÃO -->
<!-- =============================== -->
<div class="screen" id="t3">
  <div class="title">3º Passo</div>
  <div class="subtitle">Revise as informações</div>

  <div class="box">
    <h3>Resumo</h3>
    <div class="line" id="r_valor"></div>
    <div class="line" id="r_nome"></div>
    <div class="line" id="r_email"></div>
    <div class="line" id="r_presente"></div>
  </div>

  <button class="btn" onclick="registrarGAS()">Enviar e Realizar Pagamento</button>
  <button class="btn btnBack" onclick="show('t2')">Voltar</button>
</div>

<!-- =============================== -->
<!-- TELA 4 — PIX -->
<!-- =============================== -->
<div class="screen" id="t4">
  <div class="title">Pagamento PIX</div>

  <div class="box">
    <h3>Voucher Registrado</h3>
    <div class="line">Realize o pagamento para ativar:</div>
    <div class="line" id="resumoEmails"></div>
  </div>

  <div class="box">
    <h3>CHAVE PIX</h3>
    <div class="line" id="pixCode">SUA_CHAVE_PIX_AQUI</div>
    <button class="btn" onclick="copyPix()">Copiar chave</button>
  </div>

  <button class="btn btnBack" onclick="resetAll()">Voltar ao início</button>
</div>

<script>

let valor = 0;

/* -------------------------------------- */
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* -------------------------------------- */
function selectValor(v){
  valor = v;
  document.querySelectorAll('.cardValor').forEach(c=>c.classList.remove('sel'));
  event.target.classList.add('sel');
  show('t2');
}

function maskValor(i){
  let v = i.value.replace(/\D/g,"");
  v = (v/100).toFixed(2).replace('.',',');
  i.value = "R$ "+v;
}

function confirmarOutro(){
  valor = Number(outroValor.value.replace(/\D/g,""))/100;
  show('t2');
}

/* -------------------------------------- */
function maskWhats(i){
  let v = i.value.replace(/\D/g,"");
  v = v.replace(/^(\d{2})(\d)/,"($1) $2");
  v = v.replace(/(\d{5})(\d)/,"$1-$2");
  i.value = v;
}

function togglePresente(){
  emailPresente.style.display = presente.value==="sim" ? "block" : "none";
}

/* -------------------------------------- */
function validateT2(){
  if(!nome.value || !whats.value || !emailComprador.value){
    alert("Preencha todos os campos.");
    return;
  }

  r_valor.innerHTML = "<b>Valor:</b> R$ "+valor.toFixed(2).replace('.',',');
  r_nome.innerHTML = "<b>Nome:</b> "+nome.value;
  r_email.innerHTML = "<b>Email:</b> "+emailComprador.value;

  r_presente.innerHTML = presente.value==="sim"
    ? "<b>Presente para:</b> "+emailPresente.value
    : "";

  show('t3');
}

/* -------------------------------------- */
/* AQUI VOCÊ COLOCA A URL DO GAS  ↓↓↓↓↓  */
/* -------------------------------------- */
const GAS_URL = "https://script.google.com/macros/s/AKfycbzgMEe4P3xHvl0O_ATKTWdlE44u5joX6AYuazrlnMB3Wup2Mg7aKZL1K0VAfR4gxY0upA/exec";

/* -------------------------------------- */
function registrarGAS(){

  overlay.style.display="flex";

  fetch(GAS_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      acao:"registrar",
      valor,
      nomeComprador:nome.value,
      whats:whats.value,
      emailComprador:emailComprador.value,
      presente:presente.value,
      emailPresente:emailPresente.value
    })
  })
  .then(r=>r.json())
  .then(res=>{

    overlay.style.display="none";

    resumoEmails.innerHTML =
      "<b>E-mails cadastrados:</b><br>"+
      emailComprador.value+
      (presente.value==="sim" ? "<br>"+emailPresente.value : "");

    show('t4');
  });
}

/* -------------------------------------- */
function copyPix(){
  navigator.clipboard.writeText(pixCode.innerText);
  alert("Chave PIX copiada!");
}

/* -------------------------------------- */
function resetAll(){ location.reload(); }

</script>

</body>
</html>
